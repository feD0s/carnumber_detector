# Обучение и тестирование модели YoloV3-Tiny на движке darknet

## Цели и задачи проекта

    * Разобраться с работой darknet

### Были решены следующие задачи:

→ Сбор и подготовка данных:

    * Анализ предоставленных словарей с данными
    * Получение данных из словарей
    * Преобразование данных в нужный для darknet формат

→ Настройка darknet:

    * Настройка по документации
  
→ Обучение модели:

    * Запуск обучения модели.
        Модель обучалась 10 часов без GPU. За это время удалось пройти всего 200 итераций
        Модель явно недоучилась, но положительная динамика явно прослеживалась
        Результат обучения сохранен в файл yolo-obj_last.weights

→ Тестирование работы модели:

    * Тестирование работы модели осуществляется на 10 файлах
        Можно было бы сделать и больше, но в данной ситуации главное показать, что работает
        Результат записывается в файл result.txt

## Файлы и папки в репозитории

1) папка data содержит необходимые файлы для корректной работы darknet с моделью yolo v3 tiny
2) get_data.py - скрипт, преобразующий данные из словарей в формат darknet
3) yolo3_train.sh - скрипт для обучения модели
4) yolo3_test.sh - скрипт для тестирования модели
5) Darknet_Yolo.ipynb - в ноутбуке я постарался отразить ход своих мыслей. Для работы скриптов файл не нужен

## Инструкция по запуску

1) Если этого ещё не сделано, добавляем собранный и настроенный darknet в system path: export PATH="$HOME/darknet:$PATH"
2) Клонируем репозиторий git clone https://github.com/feD0s/carnumber_detector.git
3) Добавляем в папку архив "93" с картинками и pickle-файлы
4) Запускаем скрипт, преобразующий данные: python get_data.py
5) Запускаем скрипт для обучения модели: ./yolo3_train.sh
6) Запускаем скрипт для тестирования модели: ./yolo3_test.sh
7) Результат тестирования можно посмотреть в файле result.txt